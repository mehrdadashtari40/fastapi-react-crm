# render.yaml - Configuration for Render.com deployment
services:
  # Define the main backend service
  - name: fastapi-backend #  Name this service (change if you want)
    type: web # It's a web service that listens for requests
    env: python # Specify the environment (Python in this case)
    region: oregon # Choose a region 
    # Point Render to where your code lives within the repo
    rootDirectory: backend #  CRITICAL: Tells Render to look in the 'backend/' folder

    # Commands to build and start your application
    buildCommand: pip install -r requirements.txt # Runs inside 'backend/' folder
    startCommand: uvicorn app.main:app --host 0.0.0.0 --port $PORT # Runs inside 'backend/' folder

    # Environment variables needed by your application
    envVars:
      # Link to your Render PostgreSQL database
      - key: DATABASE_URL
        fromDatabase:
          name: yacrm #  CRITICAL: Must EXACTLY match your Render database service name
          property: connectionString # Gets the full DB connection string

      # Secret key for JWT signing (replace with a real generated key)
      - key: SECRET_KEY
        value: "6855583aa9becc56e30353190445e5796d336fce1d1f7427037c8f82c61326d9" #  Replace this!

      # Optional: Indicate production environment
      - key: ENV
        value: production

      # Render provides the port automatically; your app must use it
      # No need to explicitly set $PORT here, Render does it automatically